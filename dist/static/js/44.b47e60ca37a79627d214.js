webpackJsonp([44],{1120:function(e,a,t){t(1474);var n=t(10)(t(1306),t(1634),null,null);e.exports=n.exports},1137:function(e,a,t){var n,i,l;!function(d,s){i=[a,t(61),t(150)],n=s,void 0!==(l="function"==typeof n?n.apply(a,i):n)&&(e.exports=l)}(0,function(e,a,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(a),l=n(t),d={data:function(){return{tableParams:{list:[],selectList:[],page:1,pageSize:10,total:0,isCheckBoxClick:!1}}},watch:{},computed:{hasSelect:function(){return!!this.tableParams.selectList.length},tableSelectLength:function(){return this.tableParams.selectList.length},currentPage:function(){return this.tableParams.page},selectedIds:function(){var e=this;return this.tableParams.selectList.map(function(a){return a[e.pk]})}},methods:{loadList:function(){this.$Message.info("请在页面实例重写loadList")},onSearch:function(){this.tableParams.page=1,this.tableParams.selectList=[],this.loadList()},onReset:function(){this.$refs.searchForm&&(this.$refs.searchForm.resetFields(),this.onRangeChange&&"function"==typeof this.onRangeChange&&(this.rangeTime=[],this.onRangeChange([])))},onSelectionChange:function(e){this.tableParams.selectList=(0,l.default)(e),this.tableParams.isCheckBoxClick=!0},onPageChange:function(e){this.tableParams.page=e,this.tableParams.selectList=[],this.loadList()},onPageSizeChange:function(e){this.tableParams.pageSize=e,this.onSearch()},assignQuery:function(e){return(0,i.default)({page:this.tableParams.page,page_size:this.tableParams.pageSize},e)}}};e.default=d})},1147:function(e,a,t){var n,i,l;!function(t,d){i=[],n=d,void 0!==(l="function"==typeof n?n.apply(a,i):n)&&(e.exports=l)}(0,function(){"use strict"})},1306:function(e,a,t){var n,i,l;!function(d,s){i=[a,t(61),t(86),t(1137),t(509),t(52),t(1147),t(482)],n=s,void 0!==(l="function"==typeof n?n.apply(a,i):n)&&(e.exports=l)}(0,function(e,a,t,n,i,l,d,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0});var u=o(a),r=(o(n),function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]);return a.default=e,a}(i)),m=o(s),c={menu_name:[m.default.required({message:"菜单名称不能为空"}),m.default.max({max:20,message:"菜单名称长度不能超过20字符"})],menu_url:[m.default.max({max:100,message:"菜单名称长度不能超过100字符"})],menu_key:[m.default.required({message:"菜单关键字不能为空"}),m.default.max({max:100,message:"菜单关键字长度不能超过100字符"})],menu_id:[m.default.max({max:50,message:"菜单ID长度不能超过50字符"})],icon:[m.default.max({max:100,message:"菜单图标长度不能超过100字符"})],seq:[m.default.required({message:"菜单顺序不能为空"}),m.default.max({max:3,message:"菜单顺序长度不能超过3字符"})],remark:[m.default.max({max:500,message:"备注长度不能超过500字符"})]};e.default={name:"menuList",data:function(){return{ruleValidate:c,showTreeMenu:!1,showDelMenu:!1,addModal:{modal:!1,title:"新增",type:0,modalData:{menu_name:"",menu_url:"",menu_key:"",menu_id:"",parent_menu_id:"0",parent_menu_name:"父级菜单",icon:"",is_private:"0",is_hide:"N",seq:1,remark:""}},menuList:[],treeMenu:[]}},computed:(0,u.default)({},(0,t.mapState)(["userInfo"])),methods:{treeMenuOpen:function(){this.showTreeMenu=!0},treeMenuClose:function(){this.showTreeMenu=!1;var e=this.$refs.treeMenu,a=e.getSelectedNodes();a.length>0&&(this.addModal.modalData.parent_menu_id=a[0].id,this.addModal.modalData.parent_menu_name=a[0].title)},loadList:function(){var e=this;r.getMenuListApi({act_user_id:e.userInfo.user_id,parent_menu_id:"0"}).then(function(a){var t=a.resultObj;e.menuList=e.buildMenuList(t),e.treeMenu=[{id:"0",title:"父级菜单",children:e.buildTreeMenu(t),expand:!0}]})},buildMenuList:function(e){if(null!=e&&e.length>0){for(var a=e.length,t=[],n=0;n<a;n++){var i=e[n],l=i.menu_id,d=i.menu_name,s=i.menu_url,o=i.menu_key?i.menu_key:"",u=i.icon,r="1"==i.is_private?"功能菜单":"页面菜单",m="Y"==i.is_hide?"隐藏":"显示",c=i.seq?i.seq:1,p=i.children,h='<ul class="wm-menu-ul"><li class="wm-menu-icon wm-icon wm-icon-'+u+'"></li><li class="wm-menu-name"><span>'+d+'</span></li><li class="wm-menu-key">'+o+'</li><li class="wm-menu-type">'+r+'</li><li class="wm-menu-hide">'+m+'</li><li class="wm-menu-seq">'+c+'</li><li class="wm-menu-url">'+s+"</li></ul>",f={id:l,name:d,title:h,children:this.buildMenuList(p)};t[n]=f}return t}return null},buildTreeMenu:function(e){if(null!=e&&e.length>0){for(var a=e.length,t=[],n=0;n<a;n++){var i=e[n],l=i.menu_id,d=i.menu_name,s=(i.menu_url,i.menu_key&&i.menu_key,i.icon,i.is_private?i.is_private:""),o=(i.is_hide,i.seq&&i.seq,i.children);if("0"==s){var u={id:l,title:d},r=this.buildTreeMenu(o);null!=r&&r.length>0&&(u.children=r),t[n]=u}}return t}return null},addMenu:function(){this.addModal.modal=!0,this.addModal.title="新增",this.addModal.type=0,this.resetForm();var e=this.$refs.menuList,a=e.getSelectedNodes();a.length>0?(this.addModal.modalData.parent_menu_id=a[0].id,this.addModal.modalData.parent_menu_name=a[0].name):(this.addModal.modalData.parent_menu_id="0",this.addModal.modalData.parent_menu_name="父级菜单")},saveMenu:function(){var e=this;this.$refs.addMenuForm.validate(function(a){if(e.addModal.modal=!0,e.$refs.addMenuModel.visible=!0,a){var t=(0,u.default)({},e.addModal.modalData,{act_user_id:e.userInfo.user_id});0==e.addModal.type?r.menuAddApi(t).then(function(a){e.addModal.modal=!1,e.$refs.addMenuModel.visible=!1,e.resetForm(),e.loadList(),e.$Message.success("保存成功")}):r.menuUpdateApi(t).then(function(a){e.addModal.modal=!1,e.$refs.addMenuModel.visible=!1,e.loadList(),e.$Message.success("保存成功")})}})},editMenu:function(){var e=this,a=this.$refs.menuList,t=a.getSelectedNodes();if(t.length>0){this.addModal.modal=!0,this.addModal.title="编辑",this.addModal.type=1;var n=t[0].id,i={menu_id:n,act_user_id:this.userInfo.user_id};r.getMenuDetialApi(i).then(function(a){e.addModal.modalData=a.resultObj;var t=a.resultObj.parent_menu_name;null!=t&&""!=t||(e.addModal.modalData.parent_menu_id="0",e.addModal.modalData.parent_menu_name="父级菜单")})}else this.$Message.warning("请选择一条菜单记录")},delMenu:function(){this.$refs.menuList.getSelectedNodes().length>0?this.showDelMenu=!0:this.$Message.warning("请选择一条菜单记录")},delModelOK:function(){var e=this,a=this.$refs.menuList,t=a.getSelectedNodes();if(t.length>0){var n=t[0].id,i={menu_ids:n,act_user_id:this.userInfo.user_id};r.menuDelApi(i).then(function(a){e.$Message.success("删除成功"),e.loadList()})}},resetForm:function(){this.$refs.addMenuForm.resetFields(),this.addModal.modalData.parent_menu_name="父级菜单",this.addModal.modalData.prrent_menu_id="0"}},created:function(){this.loadList()}}})},1386:function(e,a,t){a=e.exports=t(1083)(),a.push([e.i,"li.wm-icon{vertical-align:top;width:60px}.wm-menu-ul{width:100%;list-style:none}ul.wm-menu-ul li{width:150px;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;height:32px;line-height:34px;margin:0 auto}.wm-menu-ul li.wm-menu-icon{width:20px;position:relative;padding-top:4px}.wm-menu-ul li.wm-menu-key{width:250px}.wm-menu-ul li.wm-menu-name span{padding-left:5px}.wm-menu-ul li.wm-menu-hide,.wm-menu-ul li.wm-menu-seq,.wm-menu-ul li.wm-menu-type{width:100px}.wm-menu-ul li.wm-menu-url{width:500px}.menu-manage .ivu-tree-arrow{line-height:38px}.menu-manage .ivu-tree-arrow-hidden{padding-left:9px}.wm-ivu-tree{height:auto;max-height:200px;overflow:auto}","",{version:3,sources:["/Users/ganqiantai/Desktop/gitWork/wm/tms-web/src/components/system/v2/menu.vue"],names:[],mappings:"AACA,WACE,mBAAoB,AACpB,UAAY,CACb,AACD,YACE,WAAY,AACZ,eAAiB,CAClB,AACD,iBACE,YAAa,AACb,qBAAsB,AACtB,gBAAiB,AACjB,mBAAoB,AACpB,uBAAwB,AACxB,YAAa,AACb,iBAAkB,AAClB,aAAe,CAChB,AACD,4BACE,WAAY,AACZ,kBAAmB,AACnB,eAAiB,CAClB,AACD,2BACE,WAAa,CACd,AACD,iCACE,gBAAkB,CACnB,AAOD,mFACE,WAAa,CACd,AACD,2BACE,WAAa,CACd,AACD,6BACE,gBAAkB,CACnB,AACD,oCACE,gBAAkB,CACnB,AACD,aACE,YAAa,AACb,iBAAkB,AAClB,aAAe,CAChB",file:"menu.vue",sourcesContent:["\nli.wm-icon {\n  vertical-align: top;\n  width: 60px;\n}\n.wm-menu-ul {\n  width: 100%;\n  list-style: none;\n}\nul.wm-menu-ul li {\n  width: 150px;\n  display: inline-block;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  height: 32px;\n  line-height: 34px;\n  margin: 0 auto;\n}\n.wm-menu-ul li.wm-menu-icon {\n  width: 20px;\n  position: relative;\n  padding-top: 4px;\n}\n.wm-menu-ul li.wm-menu-key {\n  width: 250px;\n}\n.wm-menu-ul li.wm-menu-name span {\n  padding-left: 5px;\n}\n.wm-menu-ul li.wm-menu-type {\n  width: 100px;\n}\n.wm-menu-ul li.wm-menu-hide {\n  width: 100px;\n}\n.wm-menu-ul li.wm-menu-seq {\n  width: 100px;\n}\n.wm-menu-ul li.wm-menu-url {\n  width: 500px;\n}\n.menu-manage .ivu-tree-arrow {\n  line-height: 38px;\n}\n.menu-manage .ivu-tree-arrow-hidden {\n  padding-left: 9px;\n}\n.wm-ivu-tree {\n  height: auto;\n  max-height: 200px;\n  overflow: auto;\n}\n"],sourceRoot:""}])},1474:function(e,a,t){var n=t(1386);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t(1084)("4afcc587",n,!0)},1634:function(e,a){e.exports={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"contain-head"},[t("i-button",{attrs:{type:"primary"},on:{click:e.addMenu}},[e._v("新增菜单")]),e._v(" "),t("i-button",{attrs:{type:"primary"},on:{click:e.editMenu}},[e._v("编辑菜单")]),e._v(" "),t("i-button",{attrs:{type:"primary"},on:{click:e.delMenu}},[e._v("删除菜单")])],1),e._v(" "),t("div",{staticClass:"contain-main menu-manage"},[t("Tree",{ref:"menuList",staticStyle:{display:"block"},attrs:{data:e.menuList}})],1),e._v(" "),t("Modal",{ref:"addMenuModel",attrs:{width:"700",title:e.addModal.title},on:{"on-ok":e.saveMenu},model:{value:e.addModal.modal,callback:function(a){e.$set(e.addModal,"modal",a)},expression:"addModal.modal"}},[t("Form",{ref:"addMenuForm",attrs:{rules:e.ruleValidate,model:e.addModal.modalData,"label-width":100}},[t("Form-item",{attrs:{label:"父级菜单："}},[t("Dropdown",{attrs:{trigger:"custom",visible:e.showTreeMenu,width:"100%"}},[t("a",{attrs:{href:"javascript:void(0)"},on:{click:e.treeMenuOpen}},[e._v("\n                            "+e._s(e.addModal.modalData.parent_menu_name)+"\n                            "),t("Icon",{attrs:{type:"arrow-down-b"}})],1),e._v(" "),t("Dropdown-menu",{staticStyle:{"margin-left":"10px"},attrs:{slot:"list"},slot:"list"},[t("Tree",{ref:"treeMenu",staticClass:"wm-ivu-tree",attrs:{data:e.treeMenu}}),e._v(" "),t("div",{staticStyle:{"text-align":"right",margin:"10px"}},[t("Button",{attrs:{type:"primary",size:"small"},on:{click:e.treeMenuClose}},[e._v("确定")])],1)],1)],1)],1),e._v(" "),t("Form-item",{attrs:{label:"菜单名称：",prop:"menu_name"}},[t("Input",{attrs:{placeholder:"输入菜单名称"},model:{value:e.addModal.modalData.menu_name,callback:function(a){e.$set(e.addModal.modalData,"menu_name",a)},expression:"addModal.modalData.menu_name"}})],1),e._v(" "),t("Form-item",{attrs:{label:"菜单URL：",prop:"menu_url"}},[t("Input",{attrs:{placeholder:"输入菜单URL"},model:{value:e.addModal.modalData.menu_url,callback:function(a){e.$set(e.addModal.modalData,"menu_url",a)},expression:"addModal.modalData.menu_url"}})],1),e._v(" "),t("Form-item",{attrs:{label:"菜单KEY：",prop:"menu_key"}},[t("Input",{attrs:{placeholder:"输入菜单名称关键字"},model:{value:e.addModal.modalData.menu_key,callback:function(a){e.$set(e.addModal.modalData,"menu_key",a)},expression:"addModal.modalData.menu_key"}})],1),e._v(" "),t("Row",[t("Col",{attrs:{span:"12"}},[t("Form-item",{attrs:{label:"菜单类型：",prop:"is_private"}},[t("Radio-group",{model:{value:e.addModal.modalData.is_private,callback:function(a){e.$set(e.addModal.modalData,"is_private",a)},expression:"addModal.modalData.is_private"}},[t("Radio",{attrs:{label:"0"}},[e._v("页面菜单")]),e._v(" "),t("Radio",{attrs:{label:"1"}},[e._v("功能菜单")])],1)],1)],1),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Form-item",{attrs:{label:"菜单隐藏：",prop:"is_hide"}},[t("Radio-group",{model:{value:e.addModal.modalData.is_hide,callback:function(a){e.$set(e.addModal.modalData,"is_hide",a)},expression:"addModal.modalData.is_hide"}},[t("Radio",{attrs:{label:"Y"}},[e._v("隐藏")]),e._v(" "),t("Radio",{attrs:{label:"N"}},[e._v("显示")])],1)],1)],1)],1),e._v(" "),t("Row",[t("Col",{attrs:{span:"12"}},[t("Form-item",{attrs:{label:"菜单顺序："}},[t("Input-number",{attrs:{max:999,min:1,placeholder:"输入菜单顺序"},model:{value:e.addModal.modalData.seq,callback:function(a){e.$set(e.addModal.modalData,"seq",a)},expression:"addModal.modalData.seq"}})],1)],1),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Form-item",{attrs:{label:"菜单图标：",prop:"icon"}},[t("Input",{attrs:{placeholder:"输入菜单图标"},model:{value:e.addModal.modalData.icon,callback:function(a){e.$set(e.addModal.modalData,"icon",a)},expression:"addModal.modalData.icon"}})],1)],1)],1),e._v(" "),t("Form-item",{attrs:{label:"备注：",prop:"remark"}},[t("Input",{attrs:{width:"100%",type:"textarea",placeholder:"输入备注"},model:{value:e.addModal.modalData.remark,callback:function(a){e.$set(e.addModal.modalData,"remark",a)},expression:"addModal.modalData.remark"}})],1)],1)],1),e._v(" "),t("Modal",{attrs:{title:"系统提示"},on:{"on-ok":e.delModelOK},model:{value:e.showDelMenu,callback:function(a){e.showDelMenu=a},expression:"showDelMenu"}},[t("p",[e._v("您是否确认删除该菜单")])])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=44.b47e60ca37a79627d214.js.map