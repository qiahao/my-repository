webpackJsonp([19],{1093:function(t,e,n){var r=n(10)(n(1244),null,null,null);t.exports=r.exports},1138:function(t,e,n){"use strict";e.__esModule=!0;var r=n(154),i=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t){return function(){var e=t.apply(this,arguments);return new i.default(function(t,n){function r(a,o){try{var l=e[a](o),c=l.value}catch(t){return void n(t)}if(!l.done)return i.default.resolve(c).then(function(t){r("next",t)},function(t){r("throw",t)});t(c)}return r("next")})}}},1139:function(t,e,n){t.exports=n(1148)},1148:function(t,e,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,a=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(1149),i)r.regeneratorRuntime=a;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},1149:function(t,e){!function(e){"use strict";function n(t,e,n,r){var a=e&&e.prototype instanceof i?e:i,o=Object.create(a.prototype),l=new d(r||[]);return o._invoke=u(t,n,l),o}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function a(){}function o(){}function l(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function c(t){function e(n,i,a,o){var l=r(t[n],t,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&b.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,a,o)},function(t){e("throw",t,a,o)}):Promise.resolve(u).then(function(t){c.value=t,a(c)},o)}o(l.arg)}function n(t,n){function r(){return new Promise(function(r,i){e(t,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function u(t,e,n){var i=L;return function(a,o){if(i===T)throw new Error("Generator is already running");if(i===C){if("throw"===a)throw o;return y()}for(n.method=a,n.arg=o;;){var l=n.delegate;if(l){var c=s(l,n);if(c){if(c===E)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===L)throw i=C,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=T;var u=r(t,e,n);if("normal"===u.type){if(i=n.done?C:M,u.arg===E)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=C,n.method="throw",n.arg=u.arg)}}}function s(t,e){var n=t.iterator[e.method];if(n===v){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=v,s(t,e),"throw"===e.method))return E;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,E;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=v),e.delegate=null,E):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,E)}function f(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(f,this),this.reset(!0)}function p(t){if(t){var e=t[_];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(b.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=v,e.done=!0,e};return r.next=r}}return{next:y}}function y(){return{value:v,done:!0}}var v,g=Object.prototype,b=g.hasOwnProperty,m="function"==typeof Symbol?Symbol:{},_=m.iterator||"@@iterator",w=m.asyncIterator||"@@asyncIterator",x=m.toStringTag||"@@toStringTag",k="object"==typeof t,S=e.regeneratorRuntime;if(S)return void(k&&(t.exports=S));S=e.regeneratorRuntime=k?t.exports:{},S.wrap=n;var L="suspendedStart",M="suspendedYield",T="executing",C="completed",E={},j={};j[_]=function(){return this};var F=Object.getPrototypeOf,O=F&&F(F(p([])));O&&O!==g&&b.call(O,_)&&(j=O);var q=o.prototype=i.prototype=Object.create(j);a.prototype=q.constructor=o,o.constructor=a,o[x]=a.displayName="GeneratorFunction",S.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===a||"GeneratorFunction"===(e.displayName||e.name))},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,o):(t.__proto__=o,x in t||(t[x]="GeneratorFunction")),t.prototype=Object.create(q),t},S.awrap=function(t){return{__await:t}},l(c.prototype),c.prototype[w]=function(){return this},S.AsyncIterator=c,S.async=function(t,e,r,i){var a=new c(n(t,e,r,i));return S.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},l(q),q[x]="Generator",q[_]=function(){return this},q.toString=function(){return"[object Generator]"},S.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},S.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&b.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,r){return a.type="throw",a.arg=t,n.next=e,r&&(n.method="next",n.arg=v),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var o=b.call(i,"catchLoc"),l=b.call(i,"finallyLoc");if(o&&l){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&b.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,E):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),E},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),E}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;h(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=v),E}}}(function(){return this}()||Function("return this")())},1171:function(t,e,n){var r,i,a;!function(o,l){i=[e,n(24),n(490),n(1174)],r=l,void 0!==(a="function"==typeof r?r.apply(e,i):r)&&(t.exports=a)}(0,function(t,e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(e),o=i(n),l=i(r);t.default={data:function(){return{idFlag:"item_id",tableQuery:{page_size:10,page:1},tableData:[],tableDataTotal:0,tableLeftSelection:[],tableRightSelection:[],tableSelectionTotalMap:{},tableSelectionTotalKeys:[]}},computed:{currentPage:function(){return this.tableQuery.page}},watch:{tableSelectionTotalMap:{handler:function(t,e){this.tableRightSelection=(0,l.default)(this.tableSelectionTotalMap),this.tableSelectionTotalKeys=(0,o.default)(this.tableSelectionTotalMap)},deep:!0}},methods:{handlerLeftSelectionChange:function(t){this.tableLeftSelection=this.selectionChange(this.tableLeftSelection,t)},handlerRightSelectionChange:function(t){this.tableLeftSelection=this.tableRightSelection=this.selectionChange(this.tableRightSelection,t)},selectionChange:function(t,e){var n=this,r=t.map(function(t){return t[""+n.idFlag]}),i=t.length,a=e.map(function(t){return t[""+n.idFlag]}),o=e.length,l={},c={},u=[];t.forEach(function(t){return l[t[""+n.idFlag]]=t}),e.forEach(function(t){return c[t[""+n.idFlag]]=t});var s=void 0,f=void 0,h=void 0;i<o?(s=r,i,f=a,h=o):(s=a,o,f=r,h=i);for(var d=0;d<h;d++)s.includes(f[d])||u.push(f[d]);return i<o?u.forEach(function(t){n.addTableSelectionTotalMap(t,c[t])}):u.forEach(function(t){n.removeTableSelectionTotalMap(t,l[t])}),e},handlerPageChange:function(t){this.tableQuery.page=t,this.tableSelection=[],this.loadList()},handlerPageSizeChange:function(t){this.tableQuery.page_size=t,this.tableSelection=[],this.loadList()},addTableSelectionTotalMap:function(t,e){var n=this;t&&e&&(this.tableData.forEach(function(e){e[""+n.idFlag]==t&&n.$set(e,"_checked",!0)}),this.$set(e,"_checked",!0),this.$set(this.tableSelectionTotalMap,t,e))},removeTableSelectionTotalMap:function(t,e){var n=this;if(this.tableSelectionTotalMap[t]){this.tableData.forEach(function(e){e[""+n.idFlag]==t&&(n.$delete(e,"_checked"),n.$set(e,"_checked",!1))});var r=this.tableLeftSelection.indexOf(e);this.tableLeftSelection.splice(r,1),this.$delete(this.tableSelectionTotalMap,t)}},callBackLoadList:function(t){var e=this;this.tableDataTotal=t.resultObj.total;var n=t.resultObj.list;n.length&&n.forEach(function(t){e.tableSelectionTotalMap[t[""+e.idFlag]]&&(t._checked=!0,e.tableLeftSelection.push(t))}),this.tableData=n},initTableDataCheck:function(t){return t},assignQuery:function(t){return(0,a.default)({},this.tableQuery,t)}}}})},1174:function(t,e,n){t.exports={default:n(1175),__esModule:!0}},1175:function(t,e,n){n(1177),t.exports=n(17).Object.values},1176:function(t,e,n){var r=n(104),i=n(88),a=n(121).f;t.exports=function(t){return function(e){for(var n,o=i(e),l=r(o),c=l.length,u=0,s=[];c>u;)a.call(o,n=l[u++])&&s.push(t?[n,o[n]]:o[n]);return s}}},1177:function(t,e,n){var r=n(53),i=n(1176)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},1189:function(t,e,n){var r,i,a;!function(o,l){i=[e,n(1139),n(1138),n(61),n(1198),n(1171),n(52)],r=l,void 0!==(a="function"==typeof r?r.apply(e,i):r)&&(t.exports=a)}(0,function(t,e,n,r,i,a,o){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var c=l(e),u=l(n),s=l(r),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),h=l(a);t.default={name:"financeFee",data:function(){return{query:(0,s.default)({},f.feeQuery),queryCreateTime:[],columns:f.getCulomns(this),billModalVisible:!1,bill:(0,s.default)({},f.newBill),rules:{finance_name:[{required:!0,message:"必填字段"}],finance_obj:[{required:!0,message:"必填字段"}]},refForm:null,billTypeMap:f.billTypeMap,saveBtnText:"生成对账单"}},mixins:[h.default],computed:{billId:function(){return this.$route.params.billId}},watch:{billModalVisible:function(t){var e=this;t&&(this.refForm||this.$nextTick(function(){e.refForm=e.$refs.refForm}))},queryCreateTime:function(t){this.query.create_time_begin=t[0]?o.fmt.dateFormat(t[0],"yyyy-MM-dd"):"",this.query.create_time_end=t[0]?o.fmt.dateFormat(t[1],"yyyy-MM-dd"):""}},methods:{loadList:function(){function t(){return e.apply(this,arguments)}var e=(0,u.default)(c.default.mark(function t(){var e,n;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.tableLeftSelection=[],e=this.assignQuery(this.query),t.next=4,this.$api.finance.getFeeList(e);case 4:n=t.sent,n.resultObj.list.forEach(function(t){t.cargos=JSON.parse(t.cargos||"[]")}),this.callBackLoadList(n);case 7:case"end":return t.stop()}},t,this)}));return t}(),handlerChangeCatalog:function(){var t=this;this.$nextTick(function(){"2"!=t.query.catalog&&(t.query.truck_owner=""),t.handlerSearch()})},handlerSearch:function(){this.tableQuery.page=1,this.loadList()},handlerReset:function(){this.query=(0,s.default)({},f.feeQuery),this.queryCreateTime=[],this.handlerSearch()},handlerExport:function(){},handlerAddBill:function(){this.billModalVisible=!0}}}})},1198:function(t,e,n){var r,i,a;!function(n,o){i=[e],r=o,void 0!==(a="function"==typeof r?r.apply(e,i):r)&&(t.exports=a)}(0,function(t){"use strict";function e(t){return[{type:"selection",width:60,align:"center"},{title:"运单号/车次号",key:"orderno_tripno",width:160},{title:"收付类型",key:"feepay_type",width:80,render:function(t,e){return t("span","0"==e.row.feepay_type?"支出":"收入")}},{title:"费用金额",key:"money",width:80},{title:"费用类型",key:"fee_type",width:80},{title:"对象",key:"pay_object",width:150},{title:"客户名称",key:"partner_name",width:150},{title:"起始地",key:"begin_area",width:150},{title:"目的地",key:"end_area",width:150},{title:"发货人信息",key:"begin_link",width:150},{title:"收货人信息",key:"end_link",width:150},{title:"货物",key:"cargos",width:150,render:function(t,e){return t("span",e.row.cargos.map(function(t){return t.c_name}).join(","))}},{title:"挂账时间",key:"general_time",width:160},{title:"开单时间",key:"order_create_time",width:160}]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCulomns=e;t.billTypeMap={0:"运单收入核销表",1:"运单支出核销表",2:"车费支出核销表"},t.feeQuery={catalog:"0",create_time_begin:"",create_time_end:"",keyword:"",truck_owner:""},t.newBill={item_ids:"",finance_name:"",finance_obj:""}})},1211:function(t,e,n){var r=n(10)(n(1189),n(1221),null,null);t.exports=r.exports},1221:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"contain-head"},[n("i-select",{staticClass:"w160",attrs:{placeholder:"请选择核销类型"},model:{value:t.query.catalog,callback:function(e){t.$set(t.query,"catalog",e)},expression:"query.catalog"}},t._l(t.billTypeMap,function(e,r){return n("i-option",{key:r,attrs:{label:e,value:r},nativeOn:{click:function(e){return t.handlerChangeCatalog(e)}}})})),t._v(" "),n("i-input",{staticClass:"w160",attrs:{type:"text",placeholder:"车辆所有人",disabled:"2"!=t.query.catalog},model:{value:t.query.truck_owner,callback:function(e){t.$set(t.query,"truck_owner",e)},expression:"query.truck_owner"}}),t._v(" "),n("i-input",{staticStyle:{width:"280px"},attrs:{type:"text",placeholder:"请输入运单号/车次号、客户、收支对象"},model:{value:t.query.keyword,callback:function(e){t.$set(t.query,"keyword",e)},expression:"query.keyword"}}),t._v(" "),n("DatePicker",{staticClass:"dib",attrs:{type:"daterange",placement:"bottom-end",placeholder:"选择开单时间"},model:{value:t.queryCreateTime,callback:function(e){t.queryCreateTime=e},expression:"queryCreateTime"}}),t._v(" "),n("i-button",{attrs:{type:"primary"},on:{click:t.handlerSearch}},[t._v("搜索")]),t._v(" "),n("i-button",{attrs:{type:"warning"},on:{click:t.handlerReset}},[t._v("重置")])],1),t._v(" "),n("div",{staticClass:"contain-main"},[n("Row",[n("i-col",{attrs:{span:"12 pr5"}},[n("div",[n("h3",{staticClass:"dib"},[t._v("未核销")]),t._v(" "),n("span",{staticClass:"fc-gray"},[t._v("请勾选您需要核销的费用，然后在右侧的列表中 生成对账单")])]),t._v(" "),n("i-table",{attrs:{data:t.tableData,columns:t.columns},on:{"on-selection-change":t.handlerLeftSelectionChange}}),t._v(" "),n("div",{staticClass:"page-wrapper"},[n("Page",{attrs:{total:t.tableDataTotal,"show-sizer":"","show-elevator":"",current:t.currentPage,"page-size":t.tableQuery.page_size},on:{"on-change":t.handlerPageChange,"on-page-size-change":t.handlerPageSizeChange}})],1)],1),t._v(" "),n("i-col",{attrs:{span:"12 pl5"}},[n("div",[n("h3",{staticClass:"dib"},[t._v("待核销")]),t._v(" "),n("span",{staticClass:"fc-gray"},[t._v("您可以勾选 不需要 生成对账单的费用，将其移除列表")])]),t._v(" "),n("i-table",{attrs:{data:t.tableRightSelection,columns:t.columns},on:{"on-selection-change":t.handlerRightSelectionChange}}),t._v(" "),n("div",{staticClass:"mtb25 cf"},[n("span",{staticClass:"fr"},[t.billId?n("i-button",{attrs:{type:"primary"},on:{click:t.handlerCancelEditBill}},[t._v("取消编辑")]):t._e(),t._v(" "),n("i-button",{attrs:{type:"primary",disabled:!t.tableRightSelection.length},on:{click:t.handlerAddBill}},[t._v(t._s(t.saveBtnText))])],1)])],1)],1)],1),t._v(" "),n("Modal",{attrs:{title:"对账单"},model:{value:t.billModalVisible,callback:function(e){t.billModalVisible=e},expression:"billModalVisible"}},[n("i-form",{ref:"refForm",attrs:{model:t.bill,rules:t.rules,"label-width":100}},[n("FormItem",{attrs:{label:"对账单名称",prop:"finance_name"}},[n("i-input",{attrs:{type:"text",placeholder:"请输入对账单名称"},model:{value:t.bill.finance_name,callback:function(e){t.$set(t.bill,"finance_name",e)},expression:"bill.finance_name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"对账单对象",prop:"finance_obj"}},[n("i-input",{attrs:{type:"text",placeholder:"请输入对账单对象"},model:{value:t.bill.finance_obj,callback:function(e){t.$set(t.bill,"finance_obj",e)},expression:"bill.finance_obj"}})],1)],1),t._v(" "),n("div",{staticClass:"cf",attrs:{slot:"footer"},slot:"footer"},[n("div",{staticClass:"fr"},[n("i-button",{on:{click:t.hanlderModalCancel}},[t._v("取消")]),t._v(" "),n("i-button",{attrs:{type:"primary"},on:{click:t.hanlderModalOk}},[t._v("确定")])],1)])],1)],1)},staticRenderFns:[]}},1244:function(t,e,n){var r,i,a;!function(o,l){i=[e,n(1139),n(1138),n(490),n(24),n(1211)],r=l,void 0!==(a="function"==typeof r?r.apply(e,i):r)&&(t.exports=a)}(0,function(t,e,n,r,i,a){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var l=o(e),c=o(n),u=o(r),s=o(i),f=o(a);t.default={name:"financeFee",data:function(){return{saveBtnText:"生成对账单"}},extends:f.default,watch:{},methods:{hanlderModalCancel:function(){this.bill.finance_name="",this.bill.finance_obj="",this.billModalVisible=!1,this.refForm.resetFields()},hanlderModalOk:function(){var t=this;this.refForm.validate(function(e){if(e){var n=(0,s.default)({},t.bill);n.item_ids=(0,u.default)(t.tableSelectionTotalMap).join(","),t.addBill(n)}})},addBill:function(){function t(t){return e.apply(this,arguments)}var e=(0,c.default)(l.default.mark(function t(e){return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$api.finance.addBill(e);case 2:this.tableSelectionTotalMap={},this.loadList(),this.hanlderModalCancel(),this.$Message.success("操作完成");case 6:case"end":return t.stop()}},t,this)}));return t}()},created:function(){this.loadList()}}})}});
//# sourceMappingURL=19.b2557f55bd936bf5b01f.js.map